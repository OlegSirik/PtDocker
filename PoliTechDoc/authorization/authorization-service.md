# AuthorizationService

## Ответственность
AuthorizationService является центральным механизмом авторизации.

Он обеспечивает соблюдение:
- Границ tenant'ов и учетных записей
- Проверок ролей и разрешений
- Делегирования специализированным политикам для ресурсов

## Входные данные
- Principal (аутентифицированный субъект)
- AccountContext (tenant, клиент, учетная запись)
- Действие
- Экземпляр ресурса

## Поведение
AuthorizationService:
1. Проверяет тип аутентификации (ПОЛЬЗОВАТЕЛЬ / КЛИЕНТ)
2. Выполняет глобальные проверки (tenant, состояние учетной записи)
3. Находит AuthorizationPolicy для ресурса
4. Делегирует детальные проверки политике

## Обработка ошибок
AuthorizationService выбрасывает ForbiddenException
когда доступ запрещен.

## Ограничения проектирования
- Без состояния
- Детерминированный
- Без операций записи в базу данных