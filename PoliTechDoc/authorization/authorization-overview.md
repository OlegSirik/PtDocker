# –°–∏—Å—Ç–µ–º–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
## 1. –û–±—â–∞—è –º–æ–¥–µ–ª—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

–í —Å–∏—Å—Ç–µ–º–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–≤–µ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–µ, –Ω–æ —Å–≤—è–∑–∞–Ω–Ω—ã–µ –ø–æ–¥—Å–∏—Å—Ç–µ–º—ã:
–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (Authentication) ‚Äî –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å
¬´–ö—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å?¬ª
–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è (Authorization) ‚Äî –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å
¬´–ß—Ç–æ –∏ –≤ –∫–∞–∫–æ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –µ–º—É —Ä–∞–∑—Ä–µ—à–µ–Ω–æ?¬ª
–≠—Ç–∏ –ø–æ–¥—Å–∏—Å—Ç–µ–º—ã —Ä–∞–∑–¥–µ–ª–µ–Ω—ã –Ω–∞–º–µ—Ä–µ–Ω–Ω–æ, —á—Ç–æ–±—ã:
—É–ø—Ä–æ—Å—Ç–∏—Ç—å –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ,
–æ–±–µ—Å–ø–µ—á–∏—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é —Ä–∞–±–æ—Ç—É multi-tenant –º–æ–¥–µ–ª–∏,
–ø–æ–¥–¥–µ—Ä–∂–∞—Ç—å impersonation –∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—Å–∫–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏.

## 2. –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (–∫—Ä–∞—Ç–∫–æ)

–°–∏—Å—Ç–µ–º–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –æ–ø–∏—Å–∞–Ω–∞ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –¥–æ–∫—É–º–µ–Ω—Ç–µ.
–†–µ–∑—É–ª—å—Ç–∞—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏:
–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É—Å–ø–µ—à–Ω–æ –∏–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω;
–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤–∞–ª–∏–¥–Ω—ã–π account_id, –∫ –∫–æ—Ç–æ—Ä–æ–º—É –ø—Ä–∏–≤—è–∑–∞–Ω –ª–æ–≥–∏–Ω;
—Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è security context –∑–∞–ø—Ä–æ—Å–∞.

üìå –í–∞–∂–Ω–æ:
–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –Ω–µ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø—Ä–∞–≤–∞, –∞ —Ç–æ–ª—å–∫–æ —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç, –æ—Ç –∏–º–µ–Ω–∏ –∫–∞–∫–æ–≥–æ account –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤—Ö–æ–¥.

## 3. –ò–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∞—è –º–æ–¥–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

–í —Å–∏—Å—Ç–µ–º–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∞—è (–¥–µ—Ä–µ–≤–æ–≤–∏–¥–Ω–∞—è) –º–æ–¥–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏.
Client —è–≤–ª—è–µ—Ç—Å—è Group, –∏ —É –Ω–µ–≥–æ —Ç–∞–∫–æ–π –∂–µ –Ω–∞–±–æ—Ä –ª–∏—Å—Ç—å–µ–≤.

### 3.1 –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏–µ—Ä–∞—Ä—Ö–∏–∏
~~~
Tenant
 ‚îî‚îÄ‚îÄ Client (–ø–∞—Ä—Ç–Ω—ë—Ä)
      ‚îú‚îÄ‚îÄ (Admin nodes)
      ‚îÇ    ‚îú‚îÄ‚îÄ SYS_ADMIN
      ‚îÇ    ‚îú‚îÄ‚îÄ TENANT_ADMIN
      ‚îÇ    ‚îî‚îÄ‚îÄ PRODUCT_ADMIN
      ‚îú‚îÄ‚îÄ Group
           ‚îú‚îÄ‚îÄ Portfolio (Account)
           |       ‚îú‚îÄ‚îÄ External Groups (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø)
           |       ‚îî‚îÄ‚îÄ Policy and Quotes
           ‚îî‚îÄ‚îÄ Group Admin
~~~

### 3.2 –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã

–í—Å–µ —Å—É—â–Ω–æ—Å—Ç–∏ –¥–æ—Å—Ç—É–ø–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã –∫–∞–∫ Account
Account –æ–±—Ä–∞–∑—É—é—Ç –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–µ—Ä–µ–≤—å—è
–î–µ—Ä–µ–≤—å—è —Ä–∞–∑–Ω—ã—Ö tenant –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –ø–µ—Ä–µ—Å–µ–∫–∞—é—Ç—Å—è
–î–æ—Å—Ç—É–ø –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –ø–æ–ª–æ–∂–µ–Ω–∏–µ–º –≤ –¥–µ—Ä–µ–≤–µ, –∞ –Ω–µ —Ç–æ–ª—å–∫–æ —Ä–æ–ª—å—é

## 4. Account –∫–∞–∫ –±–∞–∑–æ–≤–∞—è –µ–¥–∏–Ω–∏—Ü–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
### 4.1 –ß—Ç–æ —Ç–∞–∫–æ–µ Account

Account ‚Äî —ç—Ç–æ:
—É–∑–µ–ª –≤ –∏–µ—Ä–∞—Ä—Ö–∏–∏ –¥–æ—Å—Ç—É–ø–∞;
–∫–æ–Ω—Ç–µ–∫—Å—Ç, –≤ –∫–æ—Ç–æ—Ä–æ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å;
–µ–¥–∏–Ω–∏—Ü–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∞–≤.

–° –ø–æ–º–æ—â—å—é account –º–æ–¥–µ–ª–∏—Ä—É—é—Ç—Å—è:
–∫–ª–∏–µ–Ω—Ç—ã –∏ –ø–∞—Ä—Ç–Ω—ë—Ä—ã,
—Å—Ç—Ä–∞—Ö–æ–≤—ã–µ –ø–æ—Ä—Ç—Ñ–µ–ª–∏,
–≥—Ä—É–ø–ø—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π,
–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—Å–∫–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç—ã.

### 4.2 –ü—Ä–∏–≤—è–∑–∫–∞ –ª–æ–≥–∏–Ω–∞ –∫ account

–ö–∞–∂–¥—ã–π –ª–æ–≥–∏–Ω:
–ø—Ä–∏–≤—è–∑–∞–Ω —Ä–æ–≤–Ω–æ –∫ –æ–¥–Ω–æ–º—É account (–≤ –æ–¥–Ω–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏);
–Ω–∞—Å–ª–µ–¥—É–µ—Ç –ø—Ä–∏–≤–∏–ª–µ–≥–∏–∏ —ç—Ç–æ–≥–æ account;
–Ω–µ –º–æ–∂–µ—Ç –¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å –≤–Ω–µ —Å–≤–æ–µ–≥–æ –¥–µ—Ä–µ–≤–∞.

~~~
Login ‚Üí Account ‚Üí Position in hierarchy ‚Üí Privileges
~~~

## 5. –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—Å–∫–∏–µ account‚Äô—ã
### 5.1 –ü–æ—á–µ–º—É –∞–¥–º–∏–Ω—ã –ø—Ä–∏–≤—è–∑—ã–≤–∞—é—Ç—Å—è –∫ –∫–ª–∏–µ–Ω—Ç—É, –∞ –Ω–µ –∫ tenant

–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ account‚Äô—ã:
SYS_ADMIN
TENANT_ADMIN
PRODUCT_ADMIN
–∫—Ä–µ–ø—è—Ç—Å—è –∫ Client, –∞ –Ω–µ –Ω–∞–ø—Ä—è–º—É—é –∫ Tenant.

–ü—Ä–∏—á–∏–Ω—ã:
–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –æ–±–ª–∞—Å—Ç–∏ –¥–µ–π—Å—Ç–≤–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤
–ö–æ–Ω—Ç—Ä–æ–ª—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –∏ –∫–∞–Ω–∞–ª–æ–≤ –¥–æ—Å—Ç—É–ø–∞
–ü–æ–¥–¥–µ—Ä–∂–∫–∞ white-label –∏ partner-based deployment
–ò—Å–∫–ª—é—á–µ–Ω–∏–µ ¬´–≥–ª–æ–±–∞–ª—å–Ω—ã—Ö¬ª –∞–¥–º–∏–Ω–æ–≤ –±–µ–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º:
–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –≤—Å–µ–≥–¥–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞;
tenant-level –¥–æ—Å—Ç—É–ø –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è —è–≤–Ω–æ, –∞ –Ω–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

## 6. Principal Account vs Acting Account
### 6.1 –ó–∞—á–µ–º –Ω—É–∂–Ω—ã –¥–≤–∞ account‚Äô–∞

–í —Å–∏—Å—Ç–µ–º–µ —Ä–∞–∑–ª–∏—á–∞—é—Ç—Å—è –¥–≤–∞ —Ç–∏–ø–∞ account:
–¢–∏–ø	–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ
Principal Account	account, –∫ –∫–æ—Ç–æ—Ä–æ–º—É –ø—Ä–∏–≤—è–∑–∞–Ω –ª–æ–≥–∏–Ω
Acting Account	account, –æ—Ç –∏–º–µ–Ω–∏ –∫–æ—Ç–æ—Ä–æ–≥–æ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –æ–ø–µ—Ä–∞—Ü–∏–∏

### 6.2 –ü–æ–≤–µ–¥–µ–Ω–∏–µ –¥–ª—è –æ–±—ã—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

–î–ª—è –æ–±—ã—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:
principalAccount == actingAccount
–ü—Ä–∞–≤–∞ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é –ø–æ–ª–æ–∂–µ–Ω–∏–µ–º account –≤ –¥–µ—Ä–µ–≤–µ.

### 6.3 –ü–æ–≤–µ–¥–µ–Ω–∏–µ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤

–î–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤:
–ª–æ–≥–∏–Ω –ø—Ä–∏–≤—è–∑–∞–Ω –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—Å–∫–æ–º—É account (Client-level)
–¥–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –æ—Ç –∏–º–µ–Ω–∏ tenant account

principalAccount = CLIENT_ADMIN
actingAccount    = TENANT

–≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç:
–Ω–µ –¥—É–±–ª–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ,
—Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –¥–æ—Å—Ç—É–ø,
–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –≤–µ—Å—Ç–∏ –∞—É–¥–∏—Ç.

## 7. –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –¥–æ—Å—Ç—É–ø–∞
### 7.1 –ö–æ–≥–¥–∞ –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è acting account

actingAccount:
–≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ security context
–º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ –ë–î
–Ω–µ –∏–∑–º–µ–Ω—è–µ—Ç—Å—è –≤ —Ç–µ—á–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞

üìå –≠—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:
–≤ security-—Ñ–∏–ª—å—Ç—Ä–∞—Ö
–∏–ª–∏ –≤ UserDetailsFactory

### 7.2 –ì–¥–µ –ù–ï –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è acting account

‚ùå –ù–µ –¥–æ–ø—É—Å–∫–∞–µ—Ç—Å—è:
–≤—ã—á–∏—Å–ª—è—Ç—å acting account –≤ AuthorizationService
–º–µ–Ω—è—Ç—å –µ–≥–æ –≤ –±–∏–∑–Ω–µ—Å-—Å–µ—Ä–≤–∏—Å–∞—Ö
–æ–ø—Ä–µ–¥–µ–ª—è—Ç—å –µ–≥–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞ (policy, claim –∏ —Ç.–ø.)

## 8. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
### 8.1 –ë–∞–∑–æ–≤–æ–µ –ø—Ä–∞–≤–∏–ª–æ –¥–æ—Å—Ç—É–ø–∞

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø –∫ —Ä–µ—Å—É—Ä—Å—É, –µ—Å–ª–∏:
actingAccount –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤—ã—à–µ –∏–ª–∏ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å account —Ä–µ—Å—É—Ä—Å–∞ –≤ –∏–µ—Ä–∞—Ä—Ö–∏–∏
–ò–Ω–∞—á–µ ‚Äî –¥–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â—ë–Ω.

### 8.2 –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –æ—Ç–¥–µ–ª—å–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ tenant

–û—Ç–¥–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ tenant –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è, –ø–æ—Ç–æ–º—É —á—Ç–æ:
account‚Äô—ã —Ä–∞–∑–Ω—ã—Ö tenant –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ —Ä–∞–∑–Ω—ã—Ö –¥–µ—Ä–µ–≤—å—è—Ö;
–ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –Ω–∞ —É—Ä–æ–≤–Ω–µ –¥–∞–Ω–Ω—ã—Ö.
–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ –∏–µ—Ä–∞—Ä—Ö–∏–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–∫–ª—é—á–∞–µ—Ç –º–µ–∂—Ç–µ–Ω–∞–Ω—Ç–Ω—ã–π –¥–æ—Å—Ç—É–ø.

## 9. –†–µ–∑—É–ª—å—Ç–∞—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

–ü—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –¥–æ—Å—Ç—É–ø–∞ –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è 403 Forbidden
–û—à–∏–±–∫–∞ –æ–∑–Ω–∞—á–∞–µ—Ç: ¬´–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω, –Ω–æ –Ω–µ –∏–º–µ–µ—Ç –ø—Ä–∞–≤ –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏¬ª

## 10. –ê—É–¥–∏—Ç –∏ —Ç—Ä–∞—Å—Å–∏—Ä—É–µ–º–æ—Å—Ç—å

–ö–∞–∂–¥–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ–¥–Ω–æ–∑–Ω–∞—á–Ω–æ –∑–∞–∞—É–¥–∏—Ä–æ–≤–∞–Ω–æ:
principalAccount ‚Üí actingAccount ‚Üí resource ‚Üí action

–≠—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç:
–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π audit trail
–ø–æ–¥–¥–µ—Ä–∂–∫—É impersonation
–∞–Ω–∞–ª–∏–∑ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

## 11. –ú–æ–¥–µ–ª—å –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π (Privileges Model)
### 12.1 –û–±—â–∏–π –ø—Ä–∏–Ω—Ü–∏–ø

–ö–∞–∂–¥–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ –≤ —Å–∏—Å—Ç–µ–º–µ —Ç—Ä–µ–±—É–µ—Ç –Ω–∞–ª–∏—á–∏—è —è–≤–Ω–æ–π –ø—Ä–∏–≤–∏–ª–µ–≥–∏–∏.
–ü—Ä–∏–≤–∏–ª–µ–≥–∏—è –æ–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è —Å—Ç—Ä–æ–∫–æ–π –≤–∏–¥–∞:
~~~
<resource>:<action>
~~~

–ü—Ä–∏–º–µ—Ä—ã:
~~~
POLICY:CREATE
POLICY:VIEW
POLICY:EDIT
CLAIM:REGISTER
PRODUCT:SELL
DOCUMENT:GENERATE
~~~

üìå –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–∏ –≤—Å–µ–≥–¥–∞ –æ–∑–Ω–∞—á–∞–µ—Ç –∑–∞–ø—Ä–µ—Ç, –¥–∞–∂–µ –µ—Å–ª–∏ –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∏–π –¥–æ—Å—Ç—É–ø —Ä–∞–∑—Ä–µ—à—ë–Ω.

### 11.2 –†–æ–ª—å ‚â† –ø—Ä–∏–≤–∏–ª–µ–≥–∏—è

–í —Å–∏—Å—Ç–µ–º–µ —Ä–æ–ª–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ—Å—Ç—É–ø–∞.
–†–æ–ª—å ‚Äî —ç—Ç–æ:
–ª–æ–≥–∏—á–µ—Å–∫–∞—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞
–ø—Ä–µ–¥–Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –Ω–∞–±–æ—Ä –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π

–ü—Ä–∏–≤–∏–ª–µ–≥–∏—è ‚Äî —ç—Ç–æ:
–º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∞—Ç–æ–º–∞—Ä–Ω–∞—è –µ–¥–∏–Ω–∏—Ü–∞ –¥–æ—Å—Ç—É–ø–∞
–æ–±—ä–µ–∫—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤ AuthorizationService

### 11.3 –°–≤—è–∑—å —Ä–æ–ª–µ–π –∏ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π

–ö–∞–∂–¥–æ–π —Ä–æ–ª–∏ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω –Ω–∞–±–æ—Ä –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π, –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–π –≤ –∫–æ–¥–µ.
–ü—Ä–∏–º–µ—Ä —Ä–æ–ª–µ–π:
~~~
ADMIN
SELLER
PRODUCT_ADMIN
READ_ONLY
~~~

–ö–∞–∂–¥–∞—è —Ä–æ–ª—å —Å–æ–¥–µ—Ä–∂–∏—Ç —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ –¥–æ–ø—É—Å—Ç–∏–º—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π.
–ü—Ä–∏–º–µ—Ä (AuthZ.class)
~~~
public final class AuthZ {

    public enum Role {
        ADMIN,
        SELLER,
        PRODUCT_ADMIN
    }

    public static final Map<Role, Set<String>> ROLE_PRIVILEGES = Map.of(
        Role.ADMIN, Set.of(
            "POLICY:CREATE",
            "POLICY:EDIT",
            "POLICY:VIEW",
            "CLAIM:REGISTER",
            "DOCUMENT:GENERATE"
        ),
        Role.SELLER, Set.of(
            "POLICY:CREATE",
            "POLICY:VIEW",
            "PRODUCT:SELL"
        ),
        Role.PRODUCT_ADMIN, Set.of(
            "PRODUCT:CREATE",
            "PRODUCT:EDIT",
            "PRODUCT:PUBLISH"
        )
    );
}
~~~
### 11.4 –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–∞ (–ø–æ–ª–Ω–∞—è —Å—Ö–µ–º–∞)

–î–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ª—é–±–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è —Å–∏—Å—Ç–µ–º–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –¥–≤–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏:

1. –ò–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–∞

–ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è, —á—Ç–æ:
~~~
actingAccount ‚äá resourceAccount
~~~
–¢–æ –µ—Å—Ç—å acting account –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
—Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å account —Ä–µ—Å—É—Ä—Å–∞
–∏–ª–∏ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤—ã—à–µ –≤ –∏–µ—Ä–∞—Ä—Ö–∏–∏

2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–∏

–ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è, —á—Ç–æ —Ä–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å–æ–¥–µ—Ä–∂–∏—Ç –ø—Ä–∏–≤–∏–ª–µ–≥–∏—é:
~~~
<resource>:<action>
~~~

–ï—Å–ª–∏ —Ö–æ—Ç—è –±—ã –æ–¥–Ω–∞ –∏–∑ –ø—Ä–æ–≤–µ—Ä–æ–∫ –Ω–µ –ø—Ä–æ–π–¥–µ–Ω–∞ ‚Üí –¥–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â—ë–Ω.

### 11.5 –ò—Ç–æ–≥–æ–≤–æ–µ –ø—Ä–∞–≤–∏–ª–æ –¥–æ—Å—Ç—É–ø–∞
Access allowed ‚áî
    hierarchyCheck == true
    AND
    privilegeCheck == true

### 11.6 –ü–æ—á–µ–º—É –ø—Ä–∏–≤–∏–ª–µ–≥–∏–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –≤ –∫–æ–¥–µ

–ü—Ä–∏–≤–∏–ª–µ–≥–∏–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ AuthZ.class, –∞ –Ω–µ –≤ –ë–î, –ø–æ—Ç–æ–º—É —á—Ç–æ:
–æ–Ω–∏ —è–≤–ª—è—é—Ç—Å—è —á–∞—Å—Ç—å—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞
–º–µ–Ω—è—é—Ç—Å—è —Ä–µ–¥–∫–æ –∏ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É—é—Ç—Å—è –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ–º
—É–ø—Ä–æ—â–∞—é—Ç –∞–Ω–∞–ª–∏–∑ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
–∏—Å–∫–ª—é—á–∞—é—Ç ¬´–º–∞–≥–∏—á–µ—Å–∫–∏–µ¬ª –ø—Ä–∞–≤–∞ –≤ –¥–∞–Ω–Ω—ã—Ö

–ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –º–æ–¥–µ–ª—å –º–æ–∂–µ—Ç –±—ã—Ç—å —Ä–∞—Å—à–∏—Ä–µ–Ω–∞ –¥–æ:
permission templates
product-specific privileges
feature flags

### 11.7 –ü–æ–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–∏

–ï—Å–ª–∏ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
–µ—Å—Ç—å –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∏–π –¥–æ—Å—Ç—É–ø –Ω–æ –Ω–µ—Ç –ø—Ä–∏–≤–∏–ª–µ–≥–∏–∏, —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
403 Forbidden

–°–µ–º–∞–Ω—Ç–∏–∫–∞:

¬´–î–æ—Å—Ç—É–ø –∫ —Ä–µ—Å—É—Ä—Å—É —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –Ω–æ –¥–µ–π—Å—Ç–≤–∏–µ –∑–∞–ø—Ä–µ—â–µ–Ω–æ¬ª

## –°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã
- security/authentication.md
- authorization/rbac-model.md
- adr/ADR-004-authorization.md
