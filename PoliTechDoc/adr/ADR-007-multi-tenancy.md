# ADR-007: Модель мульти-тенантности

## Статус
Принято

## Контекст
Система обслуживает несколько tenants в рамках одного деплоя.
Tenant представляет изолированную бизнес-сущность.

## Решение
Используется модель shared-database с tenant-aware логикой.

Tenant-контекст определяется на каждый запрос и передаётся
через AccountContext.

Информация о tenant НЕ хранится в OAuth2 токенах.

## Определение tenant
Tenant определяется из:
- URL пути
- HTTP заголовка

Определение выполняется после аутентификации
и до авторизации.

## Влияние на авторизацию
- Все проверки авторизации учитывают tenant
- Межтенантный доступ запрещён явно

## Рассмотренные альтернативы

### Отдельная БД на tenant
Отклонено из-за сложности эксплуатации.

### Tenant в JWT
Отклонено из-за разрастания ролей и рисков безопасности.

## Последствия
- Жёсткая изоляция tenants на уровне приложения
- Чёткое разделение identity и tenancy
