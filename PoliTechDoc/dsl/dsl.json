{
    "calculator": {
      "code": "NS_CLASSIC",
      "name": "Классический НС в ЛКП",
      
      "context": [
        { "code": "policyHolderType", "name": "Тип страхователя" },
        { "code": "selectedCovers", "name": "Выбранные покрытия" },
        { "code": "includeSport", "name": "Включить спорт", "type": "BOOLEAN" },
        { "code": "selectedSportTypes", "name": "Выбранные виды спорта" },
        { "code": "sumInsured", "name": "Страховая сумма", "type": "NUMBER" },
        { "code": "policyTermDays", "name": "Срок страхования в днях", "type": "NUMBER" },
        { "code": "startDate", "name": "Дата начала", "type": "DATE" },
        { "code": "paymentDate", "name": "Дата оплаты", "type": "DATE" },
        { "code": "insuredAge", "name": "Возраст застрахованного", "type": "NUMBER" },
        { "code": "selectedBenefitTable", "name": "Таблица выплат" },
        { "code": "disableSickLeave", "name": "Отказ от листка нетрудоспособности", "type": "BOOLEAN" },
        { "code": "vnDailyPercent", "name": "Процент выплаты в день по ВН", "type": "NUMBER" },
        { "code": "vnMaxPercent", "name": "Максимальный процент выплаты по ВН", "type": "NUMBER" },
        { "code": "vnMinDays", "name": "Минимальное количество дней нетрудоспособности", "type": "NUMBER" },
        { "code": "vnStartDay", "name": "Начиная с какого дня выплата", "type": "NUMBER" },
        { "code": "disabilityOption", "name": "Вариант выплат по инвалидности" },
        { "code": "coveragePeriod", "name": "Период ответственности" },
        { "code": "branchCode", "name": "Код филиала" }
      ],
  
      "covers": [
        {
          "code": "ACCIDENT_DEATH",
          "name": "Смерть в результате НС",
          "isMandatory": true,
          "fields": [
            { "suffix": "sumInsured", "name": "Страховая сумма" },
            { "suffix": "premium", "name": "Премия" }
          ]
        },
        {
          "code": "ACCIDENT_DISABILITY",
          "name": "Инвалидность в результате НС",
          "isMandatory": false,
          "fields": [
            { "suffix": "sumInsured", "name": "Страховая сумма" },
            { "suffix": "premium", "name": "Премия" }
          ],
          "payoutOptions": [
            { "code": "OPTION_1", "description": "100% - 1гр., 80% - 2гр., 60% - 3гр." },
            { "code": "OPTION_2", "description": "80% - 1гр., 60% - 2гр., 40% - 3гр." },
            { "code": "OPTION_3", "description": "75% - 1гр., 50% - 2гр., 30% - 3гр." }
          ]
        },
        {
          "code": "TEMP_DISABILITY",
          "name": "Временная нетрудоспособность",
          "isMandatory": false,
          "fields": [
            { "suffix": "sumInsured", "name": "Страховая сумма" },
            { "suffix": "premium", "name": "Премия" }
          ],
          "benefitTables": ["ЗАЩИТА", "УНИВЕРСАЛ", "СПОРТ", "ПРЕМИУМ"],
          "dailyPercentageOptions": [0.05, 0.1, 0.2, 0.3, 0.4, 0.5],
          "maxPayoutOptions": [15, 25, 35, 100]
        },
        {
          "code": "EMERGENCY_HOSPITALIZATION",
          "name": "Экстренная госпитализация",
          "isMandatory": false,
          "fields": [
            { "suffix": "sumInsured", "name": "Страховая сумма" },
            { "suffix": "premium", "name": "Премия" }
          ],
          "dailyPercentageOptions": [0.05, 0.1, 0.2, 0.3, 0.4, 0.5],
          "maxPayoutOptions": [10, 25, 50, 100]
        }
      ],
  
      "variables": [
        { "code": "BASE_RATE", "name": "Базовая ставка", "kind": "CONST", "value": 0.0002 },
        { "code": "base_premium", "name": "Базовая премия", "kind": "VAR" },
        { "code": "premium_with_table", "name": "Премия с учетом таблицы", "kind": "VAR" },
        { "code": "premium_with_options", "name": "Премия с учетом опций", "kind": "VAR" },
        { "code": "final_premium", "name": "Итоговая премия", "kind": "VAR" },
        { "code": "K_SPORT_EXTREME", "name": "Коэф. за экстремальный спорт", "kind": "COEFF" },
        { "code": "K_SPORT_REGULAR", "name": "Коэф. за обычный спорт", "kind": "COEFF" }
      ],
  
      "coefficients": [
        {
          "code": "K_TABLE_ZASHITA",
          "name": "Коэф. таблицы Защита",
          "conditions": [
            { "when": { "left": "selectedBenefitTable", "operator": "==", "right": "ЗАЩИТА" }, "value": 1.0 }
          ]
        },
        {
          "code": "K_TABLE_UNIVERSAL",
          "name": "Коэф. таблицы Универсал",
          "conditions": [
            { "when": { "left": "selectedBenefitTable", "operator": "==", "right": "УНИВЕРСАЛ" }, "value": 0.85 }
          ]
        },
        {
          "code": "K_TABLE_SPORT",
          "name": "Коэф. таблицы Спорт",
          "conditions": [
            { "when": { "left": "selectedBenefitTable", "operator": "==", "right": "СПОРТ" }, "value": 1.0 }
          ]
        },
        {
          "code": "K_TABLE_PREMIUM",
          "name": "Коэф. таблицы Премиум",
          "conditions": [
            { "when": { "left": "selectedBenefitTable", "operator": "==", "right": "ПРЕМИУМ" }, "value": 0.8 }
          ]
        },
        {
          "code": "K_NO_SICK_LEAVE",
          "name": "Коэф. отказа от б/л",
          "conditions": [
            { "when": { "left": "disableSickLeave", "operator": "==", "right": true }, "value": 1.2 },
            { "when": { "left": "disableSickLeave", "operator": "==", "right": false }, "value": 1.0 }
          ]
        },
        {
          "code": "K_TERM_1_5",
          "name": "Коэф. срока от 1 до 5 дней",
          "conditions": [
            { 
              "when": { 
                "left": "policyTermDays", 
                "operator": "BETWEEN", 
                "right": [1, 5] 
              }, 
              "value": 0.10 
            }
          ]
        },
        {
          "code": "K_TERM_6_10",
          "name": "Коэф. срока от 6 до 10 дней",
          "conditions": [
            { 
              "when": { 
                "left": "policyTermDays", 
                "operator": "BETWEEN", 
                "right": [6, 10] 
              }, 
              "value": 0.14 
            }
          ]
        },
        {
          "code": "K_AGE_FACTOR",
          "name": "Возрастной коэффициент",
          "conditions": [
            { "when": { "left": "insuredAge", "operator": "<", "right": 18 }, "value": 1.2 },
            { "when": { "left": "insuredAge", "operator": "BETWEEN", "right": [18, 40] }, "value": 1.0 },
            { "when": { "left": "insuredAge", "operator": "BETWEEN", "right": [41, 60] }, "value": 1.3 },
            { "when": { "left": "insuredAge", "operator": ">", "right": 60 }, "value": 1.8 }
          ]
        }
      ],
  
      "formulas": [
        {
          "line": 1,
          "description": "Базовая премия = ставка × страховая сумма",
          "result": "base_premium",
          "left": "BASE_RATE",
          "operator": "*",
          "right": "sumInsured"
        },
        {
          "line": 2,
          "description": "Применение коэффициента таблицы выплат",
          "result": "premium_with_table",
          "left": "base_premium",
          "operator": "*",
          "right": "K_TABLE_{selectedBenefitTable}"
        },
        {
          "line": 3,
          "description": "Применение коэффициента отказа от больничного",
          "result": "premium_with_options",
          "left": "premium_with_table",
          "operator": "*",
          "right": "K_NO_SICK_LEAVE"
        },
        {
          "line": 4,
          "description": "Применение коэффициента срока",
          "result": "premium_with_term",
          "left": "premium_with_options",
          "operator": "*",
          "right": "K_TERM_{policyTermDays}"
        },
        {
          "line": 5,
          "description": "Применение возрастного коэффициента",
          "result": "final_premium",
          "left": "premium_with_term",
          "operator": "*",
          "right": "K_AGE_FACTOR"
        },
        {
          "line": 6,
          "description": "Применение спортивного коэффициента (экстремальный спорт)",
          "condition": {
            "left": "includeSport",
            "operator": "==",
            "right": true,
            "and": {
              "left": "selectedSportTypes",
              "operator": "CONTAINS",
              "right": "экстремальный"
            }
          },
          "result": "final_premium",
          "left": "final_premium",
          "operator": "*",
          "right": "K_SPORT_EXTREME"
        },
        {
          "line": 7,
          "description": "Применение спортивного коэффициента (обычный спорт)",
          "condition": {
            "left": "includeSport",
            "operator": "==",
            "right": true,
            "and": {
              "left": "selectedSportTypes",
              "operator": "CONTAINS",
              "right": "обычный"
            }
          },
          "result": "final_premium",
          "left": "final_premium",
          "operator": "*",
          "right": "K_SPORT_REGULAR"
        }
      ],
  
      "validators": [
        {
          "stage": "QUOTE",
          "description": "Диапазон страховых сумм (мин)",
          "condition": {
            "left": "sumInsured",
            "operator": ">=",
            "right": 10000
          },
          "message": "Минимальная страховая сумма 10 000 руб."
        },
        {
          "stage": "QUOTE",
          "description": "Диапазон страховых сумм (макс)",
          "condition": {
            "left": "sumInsured",
            "operator": "<=",
            "right": 10000000
          },
          "message": "Максимальная страховая сумма 10 000 000 руб."
        },
        {
          "stage": "QUOTE",
          "description": "Ограничение по сумме при экстремальном спорте",
          "condition": {
            "left": "sumInsured",
            "operator": "<=",
            "right": 350000,
            "and": {
              "left": "includeSport",
              "operator": "==",
              "right": true,
              "and": {
                "left": "selectedSportTypes",
                "operator": "CONTAINS",
                "right": "экстремальный"
              }
            }
          },
          "message": "При экстремальном спорте максимальная страховая сумма 350 000 руб."
        },
        {
          "stage": "QUOTE",
          "description": "Минимальный возраст",
          "condition": {
            "left": "insuredAge",
            "operator": ">=",
            "right": 0.5
          },
          "message": "Возраст застрахованного должен быть не менее 0.5 года"
        },
        {
          "stage": "QUOTE",
          "description": "Максимальный возраст",
          "condition": {
            "left": "insuredAge",
            "operator": "<=",
            "right": 80
          },
          "message": "Возраст застрахованного должен быть не более 80 лет"
        },
        {
          "stage": "QUOTE",
          "description": "Ограничение по риску ВН для лиц младше 18",
          "condition": {
            "left": "TEMP_DISABILITY.sumInsured",
            "operator": "<=",
            "right": 500000,
            "and": {
              "left": "insuredAge",
              "operator": "<",
              "right": 18
            }
          },
          "message": "Для лиц младше 18 лет максимальная сумма по риску ВН 500 000 руб."
        },
        {
          "stage": "QUOTE",
          "description": "Ограничение по риску ВН для лиц старше 65",
          "condition": {
            "left": "TEMP_DISABILITY.sumInsured",
            "operator": "<=",
            "right": 500000,
            "and": {
              "left": "insuredAge",
              "operator": ">",
              "right": 65
            }
          },
          "message": "Для лиц старше 65 лет максимальная сумма по риску ВН 500 000 руб."
        },
        {
          "stage": "QUOTE",
          "description": "Сумма по инвалидности не может превышать сумму по смерти",
          "condition": {
            "left": "ACCIDENT_DISABILITY.sumInsured",
            "operator": "<=",
            "right": "ACCIDENT_DEATH.sumInsured"
          },
          "message": "Страховая сумма по риску Инвалидность не может превышать сумму по риску Смерть"
        },
        {
          "stage": "SAVE",
          "description": "Обязательное покрытие - Смерть",
          "condition": {
            "left": "selectedCovers",
            "operator": "CONTAINS",
            "right": "ACCIDENT_DEATH"
          },
          "message": "Риск Смерть в результате НС является обязательным"
        }
      ],
  
      "numberGenerator": {
        "description": "13-тизначная нумерация: ГГ ФФ 0 YZ XXXXXX",
        "mask": "{YY}{branchCode}0{PRODUCT_CODE}{XXXXXX}"
      }
    }
  }