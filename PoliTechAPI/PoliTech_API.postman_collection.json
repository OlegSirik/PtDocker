{
	"info": {
		"_postman_id": "politech-api-collection",
		"name": "PoliTech API - JWT Auth",
		"description": "Коллекция для тестирования API с JWT авторизацией",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"auth": {
		"type": "bearer",
		"bearer": [
			{
				"key": "token",
				"value": "{{jwt_token}}",
				"type": "string"
			}
		]
	},
	"variable": [
		{
			"key": "base_url",
			"value": "http://localhost:8080",
			"type": "string"
		},
		{
			"key": "jwt_token",
			"value": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZG1pbiIsImV4cCI6MTk5OTk5OTk5OSwiaWF0IjoxNzAwMDAwMDAwfQ.sample",
			"type": "string"
		}
	],
	"item": [
		{
			"name": "Auth",
			"item": [
				{
					"name": "Get Current User",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/auth/me",
							"host": ["{{base_url}}"],
							"path": ["api", "auth", "me"]
						},
						"description": "Получить информацию о текущем пользователе"
					}
				},
				{
					"name": "Get User Context",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/auth/context",
							"host": ["{{base_url}}"],
							"path": ["api", "auth", "context"]
						},
						"description": "Получить контекст пользователя через SecurityContextHelper"
					}
				},
				{
					"name": "Check Product Access",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/auth/check-product-access",
							"host": ["{{base_url}}"],
							"path": ["api", "auth", "check-product-access"]
						},
						"description": "Проверить доступ к продуктам"
					}
				},
				{
					"name": "Admin Only Endpoint",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/auth/admin-only",
							"host": ["{{base_url}}"],
							"path": ["api", "auth", "admin-only"]
						},
						"description": "Endpoint только для ADMIN роли"
					}
				}
			],
			"description": "Endpoints для аутентификации и проверки прав"
		},
		{
			"name": "Admin Products",
			"item": [
				{
					"name": "List Products",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/admin/products",
							"host": ["{{base_url}}"],
							"path": ["admin", "products"]
						},
						"description": "Получить список всех продуктов (требуется ADMIN)"
					}
				},
				{
					"name": "Create Product",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"productCode\": \"TEST_PRODUCT\",\n  \"productName\": \"Test Product\",\n  \"versionNo\": 1,\n  \"effectiveDate\": \"2024-01-01\",\n  \"expiryDate\": \"2025-12-31\",\n  \"isActive\": true\n}"
						},
						"url": {
							"raw": "{{base_url}}/admin/products",
							"host": ["{{base_url}}"],
							"path": ["admin", "products"]
						},
						"description": "Создать новый продукт (требуется ADMIN)"
					}
				},
				{
					"name": "Get Product Version",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/admin/products/1/versions/1",
							"host": ["{{base_url}}"],
							"path": ["admin", "products", "1", "versions", "1"]
						},
						"description": "Получить версию продукта (требуется ADMIN)"
					}
				},
				{
					"name": "Update Product Version",
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"productCode\": \"TEST_PRODUCT\",\n  \"productName\": \"Updated Test Product\",\n  \"versionNo\": 1,\n  \"isActive\": true\n}"
						},
						"url": {
							"raw": "{{base_url}}/admin/products/1/versions/1",
							"host": ["{{base_url}}"],
							"path": ["admin", "products", "1", "versions", "1"]
						},
						"description": "Обновить версию продукта (требуется ADMIN)"
					}
				},
				{
					"name": "Create New Version",
					"request": {
						"method": "POST",
						"header": [],
						"url": {
							"raw": "{{base_url}}/admin/products/1/versions/1/cmd/create",
							"host": ["{{base_url}}"],
							"path": ["admin", "products", "1", "versions", "1", "cmd", "create"]
						},
						"description": "Создать новую версию продукта (требуется ADMIN)"
					}
				},
				{
					"name": "Delete Product",
					"request": {
						"method": "DELETE",
						"header": [],
						"url": {
							"raw": "{{base_url}}/admin/products/1",
							"host": ["{{base_url}}"],
							"path": ["admin", "products", "1"]
						},
						"description": "Удалить продукт (soft delete) (требуется ADMIN)"
					}
				},
				{
					"name": "Delete Product Version",
					"request": {
						"method": "DELETE",
						"header": [],
						"url": {
							"raw": "{{base_url}}/admin/products/1/versions/2",
							"host": ["{{base_url}}"],
							"path": ["admin", "products", "1", "versions", "2"]
						},
						"description": "Удалить версию продукта (требуется ADMIN)"
					}
				},
				{
					"name": "Get Quote Example JSON",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/admin/products/1/versions/1/example_quote",
							"host": ["{{base_url}}"],
							"path": ["admin", "products", "1", "versions", "1", "example_quote"]
						},
						"description": "Получить пример JSON для расчёта (требуется ADMIN)"
					}
				},
				{
					"name": "Get Save Example JSON",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/admin/products/1/versions/1/example_save",
							"host": ["{{base_url}}"],
							"path": ["admin", "products", "1", "versions", "1", "example_save"]
						},
						"description": "Получить пример JSON для сохранения (требуется ADMIN)"
					}
				}
			],
			"description": "Управление продуктами (только ADMIN)"
		},
		{
			"name": "Admin Files",
			"item": [
				{
					"name": "List Files",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/admin/files?product_code=TEST_PRODUCT",
							"host": ["{{base_url}}"],
							"path": ["admin", "files"],
							"query": [
								{
									"key": "product_code",
									"value": "TEST_PRODUCT"
								}
							]
						},
						"description": "Получить список файлов (требуется ADMIN)"
					}
				},
				{
					"name": "Create File Metadata",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"fileType\": \"pdf\",\n  \"fileDescription\": \"Test document\",\n  \"productCode\": \"TEST_PRODUCT\",\n  \"packageCode\": \"1\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/admin/files",
							"host": ["{{base_url}}"],
							"path": ["admin", "files"]
						},
						"description": "Создать метаданные файла (требуется ADMIN)"
					}
				},
				{
					"name": "Upload File",
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "formdata",
							"formdata": [
								{
									"key": "file",
									"type": "file",
									"src": []
								}
							]
						},
						"url": {
							"raw": "{{base_url}}/admin/files/1",
							"host": ["{{base_url}}"],
							"path": ["admin", "files", "1"]
						},
						"description": "Загрузить файл (требуется ADMIN)"
					}
				},
				{
					"name": "Download File",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/admin/files/1",
							"host": ["{{base_url}}"],
							"path": ["admin", "files", "1"]
						},
						"description": "Скачать файл (требуется ADMIN)"
					}
				},
				{
					"name": "Process File",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "[\n  {\n    \"varCode\": \"CLIENT_NAME\",\n    \"varValue\": \"John Doe\"\n  },\n  {\n    \"varCode\": \"POLICY_NUMBER\",\n    \"varValue\": \"POL-12345\"\n  }\n]"
						},
						"url": {
							"raw": "{{base_url}}/admin/files/1/cmd/process",
							"host": ["{{base_url}}"],
							"path": ["admin", "files", "1", "cmd", "process"]
						},
						"description": "Обработать файл с подстановкой переменных (требуется ADMIN)"
					}
				},
				{
					"name": "Delete File",
					"request": {
						"method": "DELETE",
						"header": [],
						"url": {
							"raw": "{{base_url}}/admin/files/1",
							"host": ["{{base_url}}"],
							"path": ["admin", "files", "1"]
						},
						"description": "Удалить файл (soft delete) (требуется ADMIN)"
					}
				}
			],
			"description": "Управление файлами (только ADMIN)"
		},
		{
			"name": "Admin Calculator",
			"item": [
				{
					"name": "Get Calculator",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/admin/products/1/versions/1/packages/1/calculator",
							"host": ["{{base_url}}"],
							"path": ["admin", "products", "1", "versions", "1", "packages", "1", "calculator"]
						},
						"description": "Получить калькулятор (требуется ADMIN)"
					}
				},
				{
					"name": "Create Calculator",
					"request": {
						"method": "POST",
						"header": [],
						"url": {
							"raw": "{{base_url}}/admin/products/1/versions/1/packages/1/calculator?productCode=TEST_PRODUCT",
							"host": ["{{base_url}}"],
							"path": ["admin", "products", "1", "versions", "1", "packages", "1", "calculator"],
							"query": [
								{
									"key": "productCode",
									"value": "TEST_PRODUCT"
								}
							]
						},
						"description": "Создать калькулятор (требуется ADMIN)"
					}
				},
				{
					"name": "Update Calculator",
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"calculatorId\": 1,\n  \"productCode\": \"TEST_PRODUCT\",\n  \"formula\": \"price * coefficient\",\n  \"variables\": []\n}"
						},
						"url": {
							"raw": "{{base_url}}/admin/products/1/versions/1/packages/1/calculator?productCode=TEST_PRODUCT",
							"host": ["{{base_url}}"],
							"path": ["admin", "products", "1", "versions", "1", "packages", "1", "calculator"],
							"query": [
								{
									"key": "productCode",
									"value": "TEST_PRODUCT"
								}
							]
						},
						"description": "Обновить калькулятор (требуется ADMIN)"
					}
				},
				{
					"name": "Get Coefficients",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/admin/calculator/1/coefficients/AGE_COEF",
							"host": ["{{base_url}}"],
							"path": ["admin", "calculator", "1", "coefficients", "AGE_COEF"]
						},
						"description": "Получить таблицу коэффициентов (требуется ADMIN)"
					}
				},
				{
					"name": "Create Coefficients",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "[\n  {\"age\": 18, \"coefficient\": 1.0},\n  {\"age\": 25, \"coefficient\": 0.9},\n  {\"age\": 35, \"coefficient\": 1.1}\n]"
						},
						"url": {
							"raw": "{{base_url}}/admin/calculator/1/coefficients/AGE_COEF",
							"host": ["{{base_url}}"],
							"path": ["admin", "calculator", "1", "coefficients", "AGE_COEF"]
						},
						"description": "Создать таблицу коэффициентов (требуется ADMIN)"
					}
				},
				{
					"name": "Replace Coefficients",
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "[\n  {\"age\": 18, \"coefficient\": 1.2},\n  {\"age\": 25, \"coefficient\": 1.0},\n  {\"age\": 35, \"coefficient\": 1.3}\n]"
						},
						"url": {
							"raw": "{{base_url}}/admin/calculator/1/coefficients/AGE_COEF",
							"host": ["{{base_url}}"],
							"path": ["admin", "calculator", "1", "coefficients", "AGE_COEF"]
						},
						"description": "Заменить таблицу коэффициентов (требуется ADMIN)"
					}
				},
				{
					"name": "Sync Calculator Variables",
					"request": {
						"method": "POST",
						"header": [],
						"url": {
							"raw": "{{base_url}}/admin/calculator/1/prc/syncvars",
							"host": ["{{base_url}}"],
							"path": ["admin", "calculator", "1", "prc", "syncvars"]
						},
						"description": "Синхронизировать переменные калькулятора (требуется ADMIN)"
					}
				}
			],
			"description": "Управление калькуляторами (только ADMIN)"
		},
		{
			"name": "Admin LOBs",
			"item": [
				{
					"name": "List LOBs",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/admin/lobs",
							"host": ["{{base_url}}"],
							"path": ["admin", "lobs"]
						},
						"description": "Получить список LOBs (требуется ADMIN)"
					}
				},
				{
					"name": "Get LOB by Code",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/admin/lobs/AUTO",
							"host": ["{{base_url}}"],
							"path": ["admin", "lobs", "AUTO"]
						},
						"description": "Получить LOB по коду (требуется ADMIN)"
					}
				},
				{
					"name": "Create LOB",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"mpCode\": \"AUTO\",\n  \"mpName\": \"Automotive Insurance\",\n  \"mpVars\": [\n    {\n      \"varPath\": \"vehicle.make\",\n      \"varType\": \"string\"\n    },\n    {\n      \"varPath\": \"vehicle.model\",\n      \"varType\": \"string\"\n    }\n  ]\n}"
						},
						"url": {
							"raw": "{{base_url}}/admin/lobs",
							"host": ["{{base_url}}"],
							"path": ["admin", "lobs"]
						},
						"description": "Создать новый LOB (требуется ADMIN)"
					}
				},
				{
					"name": "Update LOB",
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"mpCode\": \"AUTO\",\n  \"mpName\": \"Updated Automotive Insurance\",\n  \"mpVars\": []\n}"
						},
						"url": {
							"raw": "{{base_url}}/admin/lobs/AUTO",
							"host": ["{{base_url}}"],
							"path": ["admin", "lobs", "AUTO"]
						},
						"description": "Обновить LOB (требуется ADMIN)"
					}
				},
				{
					"name": "Delete LOB",
					"request": {
						"method": "DELETE",
						"header": [],
						"url": {
							"raw": "{{base_url}}/admin/lobs/1",
							"host": ["{{base_url}}"],
							"path": ["admin", "lobs", "1"]
						},
						"description": "Удалить LOB (soft delete) (требуется ADMIN)"
					}
				},
				{
					"name": "Get LOB Example JSON",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/admin/lobs/AUTO/example",
							"host": ["{{base_url}}"],
							"path": ["admin", "lobs", "AUTO", "example"]
						},
						"description": "Получить пример JSON для LOB (требуется ADMIN)"
					}
				}
			],
			"description": "Управление линиями бизнеса (только ADMIN)"
		},
		{
			"name": "Database Operations",
			"item": [
				{
					"name": "Create Policy",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"productCode\": \"TEST_PRODUCT\",\n  \"policyHolder\": {\n    \"name\": \"John Doe\",\n    \"email\": \"john@example.com\"\n  },\n  \"premium\": 1000.00,\n  \"effectiveDate\": \"2024-01-01\",\n  \"expiryDate\": \"2024-12-31\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/db/policies",
							"host": ["{{base_url}}"],
							"path": ["db", "policies"]
						},
						"description": "Создать новую политику (требуется аутентификация)"
					}
				},
				{
					"name": "Update Policy",
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"policyNumber\": \"POL-12345\",\n  \"status\": \"active\",\n  \"premium\": 1200.00\n}"
						},
						"url": {
							"raw": "{{base_url}}/db/policies/POL-12345",
							"host": ["{{base_url}}"],
							"path": ["db", "policies", "POL-12345"]
						},
						"description": "Обновить существующую политику (требуется аутентификация)"
					}
				},
				{
					"name": "Get Policy by ID",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/db/policies/550e8400-e29b-41d4-a716-446655440000",
							"host": ["{{base_url}}"],
							"path": ["db", "policies", "550e8400-e29b-41d4-a716-446655440000"]
						},
						"description": "Получить политику по ID (требуется аутентификация)"
					}
				}
			],
			"description": "Операции с базой данных (требуется аутентификация)"
		},
		{
			"name": "Health Check",
			"item": [
				{
					"name": "Actuator Health",
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/actuator/health",
							"host": ["{{base_url}}"],
							"path": ["actuator", "health"]
						},
						"description": "Проверка здоровья приложения (без авторизации)"
					}
				}
			],
			"description": "Проверка состояния приложения"
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		}
	]
}

